<html>
<body onload="displayUsers()">
	<table border="1">
		<thead>
			<tr>
				<th>ID</th>
				<th>Name</th>
				<th>Address</th>
				<th>Password</th>
			</tr>
		</thead>
		<tbody id="userTable">
		</tbody>
	</table>
	<div id="viewData"></div>
	<script type="text/javascript">
		function displayUsers()
		{
			var tableData = document.getElementById("userTable").innerHTML;
			var req = new XMLHttpRequest();
			req.open("GET","display","true");
			req.send(null);
			
			req.onreadystatechange=function(){
				if(req.readyState==4 && req.status==200)
					{
						tableData ="";
						var users = JSON.parse(req.responseText);
						console.log(users);
						for(var i=0;i<users.length;i++)
							{
								tableData=tableData+"<tr>"+
														"<td>"+users[i].id+"</td>"+
														"<td>"+users[i].name+"</td>"+
														"<td>"+users[i].address+"</td>"+
														"<td>"+users[i].password+"</td>"+
														"<td><button id='"+users[i].id+"' onclick='viewbyidData(this.id)'>view</button></td>"+
														"<td><button id='"+users[i].id+"' onclick='updateData(this.id)'>update</button></td>"+
														"<td><button id='"+users[i].id+"' onclick='deleteData(this.id)'>delete</button></td>"+
														"</tr>";
								
							}
						document.getElementById("userTable").innerHTML=tableData;
					}
			}
			
			
		}
		function viewbyidData(id)
		{
			var opp = document.getElementById("viewData").innerHTML;
			var req = new XMLHttpRequest();
			req.open("GET","onedata?id="+id,"true");
			req.send(id);
			
			req.onreadystatechange=function()
			{
				if(req.readyState==4 && req.status==200)
					{
						opp = "";
						var users = JSON.parse(req.responseText);
						console.log(users);
						opp = opp + "ID: "+users.id+
									"Name: "+users.name+
									"Address: "+users.address+
									"Password: "+users.password;
						document.getElementById("viewData").innerHTML=opp;
					}
			}
		}
		
		function deleteData(id)
		{
			
			var req = new XMLHttpRequest();
			req.open("GET","delete?id="+id,"true");
			req.send(null);
			
			req.onreadystatechange=function()
			{
				if(req.readyState==4 && req.status==200)
					{
						var data = JSON.parse(req.responseText);
						console.log(data);		
						
						
						if(data.status)
							{
								console.log("data deleted successfully");
								displayUsers();	
							}
						else
							{
								console.log("data not deleted successfully");
							}
										
					}
			}
		}
		function updateData(id)
		{
			var usersdat = document.getElementById("viewData").innerHTML;
			var req = new XMLHttpRequest();
			req.open("GET","onedata?id="+id,"true");
			req.send(null);
			
			req.onreadystatechange=function()
			{
				if(req.readyState==4 && req.status==200)
					{
						var views = JSON.parse(req.responseText);
						console.log(views);
						
						
					}
			}
		}
		
	</script>
</body>
</html>
